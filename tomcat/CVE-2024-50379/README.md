# CVE-2024-50379 (WIP)
Time-of-check Time-of-use (TOCTOU) Race Condition vulnerability during JSP compilation in Apache Tomcat permits an RCE on case insensitive file systems when the default servlet is enabled for write (non-default configuration). This issue affects Apache Tomcat: from 11.0.0-M1 through 11.0.1, from 10.1.0-M1 through 10.1.33, from 9.0.0.M1 through 9.0.97. Users are recommended to upgrade to version 11.0.2, 10.1.34 or 9.0.98, which fixes the issue.

## Metrics
CVSSv2: N/A   
CVSSv3: N/A   

## Vulnerability Environment
Build and run:
```bash
docker compose build
docker compose up -d
```

Stop environment and remove network
```bash
docker compose down
```
## Detection and exploitation example
> [!IMPORTANT]
> For demonstration only. Possibly not exploitable in Linux systems, Tomcat permits an RCE on _case insensitive_ file systems.

Use https://github.com/SleepingBag945/CVE-2024-50379

Build:
```
go build
```
Or [download binary](https://github.com/SleepingBag945/CVE-2024-50379/releases/tag/f).

Generate jsp shell on [revshells.com](https://www.revshells.com/), use browser [shell fron Node Security](https://node-security.com/posts/jsp-war-shell/) or use any other.
Run:
```
./CVE-2024-50379 -u http://172.17.0.2:8080/ -f shell.jsp -p ggsl.jsp
```

## Exploits and PoCs
https://github.com/SleepingBag945/CVE-2024-50379   
https://github.com/Alchemist3dot14/CVE-2024-50379  
https://github.com/ph0ebus/Tomcat-CVE-2024-50379-Poc   
https://github.com/iSee857/CVE-2024-50379-PoC

## Nuclei Template

## CTF Rooms

## References
[NIST: CVE-2024-50379](https://nvd.nist.gov/vuln/detail/CVE-2024-50379)   
[Medium: Deep Dive & POC of CVE-2024-50379 Exploit Tomcat Vulnerability (9.8 Severity)](https://medium.com/@patelvidhi4288/deep-dive-poc-of-cve-2024-50379-exploit-tomcat-vulnerability-9-8-severity-776cfcfcf3ed)   
[Medium: CVE-2024–50379/CVE-2024–56337: Apache Tomcat Critical RCE Vulnerability](https://medium.com/@cyber_dark/cve-2024-50379-cve-2024-56337-apache-tomcat-critical-rce-vulnerability-9bbd1015ea2a)